    function renderChores() {
      const tbody = document.getElementById("chore-body");
      const today = new Date().toLocaleDateString('en-US', { weekday: 'long' });
      const fullDate = new Date();
      const fullDateString = fullDate.toLocaleDateString();
      const orderedDays = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
      tbody.innerHTML = "";
      orderedDays.forEach(day => {
        const row = document.createElement("tr");
        if (day === today) row.classList.add("highlight-row");
        const dayCell = document.createElement("td");
        dayCell.textContent = day === today ? `${day} (${fullDateString})` : day;
        row.appendChild(dayCell);

        const names = ["Jacob", "Jalyna", "Josh", "Jeremy"];
        names.forEach(name => {
          const cell = document.createElement("td");
          const tasks = chores[day]?.[name] || [];

          if (tasks.length === 0) {
            cell.innerHTML = "<em>Free</em>";
          } else {
            tasks.forEach((task, i) => {
              const id = `${name.toLowerCase()}-${day.toLowerCase()}-${i}`;
              const div = document.createElement("div");
              div.className = "task";

              const label = document.createElement("label");
              const checkbox = document.createElement("input");
              checkbox.type = "checkbox";
              checkbox.id = `${id}-checkbox`;
              checkbox.onchange = () => toggleTask(checkbox, id);
              label.appendChild(checkbox);
              label.append(task);

              const timerSpan = document.createElement("span");
              timerSpan.id = `${id}-timer`;
              timerSpan.className = "timer";

              const status = document.createElement("span");
              status.id = `${id}-status`;

              const approveBtn = document.createElement("button");
              approveBtn.id = `${id}-approve`;
              approveBtn.textContent = "Approve";
              approveBtn.style.display = "none";
              approveBtn.onclick = () => approveTask(id);

              div.appendChild(label);
              div.appendChild(timerSpan);
              div.appendChild(status);

              if (isParent) {
                div.appendChild(approveBtn);
                const timerBtn = document.createElement("button");
                timerBtn.textContent = "â±ï¸ Set Timer";
                timerBtn.className = "set-timer-btn";
                timerBtn.onclick = () => setTaskTimer(id);
                div.appendChild(timerBtn);
              }

              cell.appendChild(div);
            });
          }

          if (isParent) {
            const editBtn = document.createElement("button");
            editBtn.textContent = "âœï¸ Edit";
            editBtn.style.marginTop = "5px";
            editBtn.style.fontSize = "12px";
            editBtn.onclick = () => editTasks(day, name);
            cell.appendChild(editBtn);
          }

          row.appendChild(cell);
        });

        tbody.appendChild(row);
      });

      Object.entries(taskStatuses).forEach(([id, status]) => updateTaskUI(id, status));
    }

    function toggleTheme() {
      document.body.classList.toggle("dark");
      const label = document.getElementById("mode-label");
      const isDark = document.body.classList.contains("dark");
      label.textContent = isDark ? "â˜€ï¸ Light Mode" : "ğŸŒ™ Dark Mode";
      document.getElementById("toggle-checkbox").checked = isDark;
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (isParent) document.getElementById("rotate-section").style.display = "block";

      db.ref("weeklyChores").on("value", snapshot => {
        chores = snapshot.val() || {};
        renderChores();
      });

      db.ref("tasks").on("value", snapshot => {
        taskStatuses = snapshot.val() || {};
        renderChores();
      });

      db.ref("timers").on("value", snapshot => {
        timers = snapshot.val() || {};
        updateTimerDisplays();
      });

      updateRecyclingNote();
    });
  </script>
</head>
<body>
  <h1>Family Tasks</h1>

  <!-- Dark Mode Toggle -->
  <label class="theme-switch" for="toggle-checkbox">
    <input type="checkbox" id="toggle-checkbox" onchange="toggleTheme()" />
    <span class="slider"></span>
    <span class="mode-label" id="mode-label">ğŸŒ™ Dark Mode</span>
  </label>

  <!-- Chore Table -->
  <table>
    <thead>
      <tr><th>Day</th><th>Jacob</th><th>Jalyna</th><th>Josh</th><th>Jeremy</th></tr>
    </thead>
    <tbody id="chore-body"></tbody>
  </table>

  <!-- Rotate Button (Parent Only) -->
  <div id="rotate-section" style="display: none;">
    <button onclick="rotateChores()" style="padding: 10px 20px; font-size: 16px;">ğŸ” Rotate Tasks</button>
  </div>

  <!-- Reset All Tasks Button -->
  <div id="reset-section">
    <button onclick="resetAllTasks()" style="padding: 10px 20px; font-size: 16px;">Reset All Tasks</button>
  </div>

  <!-- Notices -->
  <div class="recycling-note">
    â™»ï¸ <strong>Recycling:</strong> Loading next pickup info...
  </div>
  <div class="garbage-note">
    ğŸ—‘ï¸ <strong>Garbage Instructions:</strong> Garbage must be taken out before 9:00 PM the night before pickup. If not done, Wi-Fi may be disabled until complete. This is checked during task approval.
  </div>

  <!-- Footer -->
  <div class="footer-note">
    âœ… Complete tasks to regain Wi-Fi privileges. Parent approval required.
  </div>
</body>
</html>
